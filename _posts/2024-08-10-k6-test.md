---
title: "[K6] K6 Test"
date: 2024-08-10
categories: [K6, Test]
tags: [K6, Test, JavaScript]
---

- Smoke Test, Load Test, Stress Test ë“± ë‹¤ì–‘í•œ í…ŒìŠ¤íŠ¸ ì§€ì›
- ì˜ˆë¥¼ ë“¤ì–´ Kubernetesì— ì• í”Œë¦¬ì¼€ì´ì…˜ Podë¥¼ ë°°í¬í•œë‹¤ê³  ê°€ì •í–ˆì„ ë•Œ, íŒŒë“œì˜ resourcesë¥¼ ì§€ì •í•´ì¤˜ì•¼ í•˜ëŠ”ë° ì–´ëŠ ì •ë„ ê°’ì„ ì¤˜ì•¼ í•˜ëŠ” ì§€ ëª¨ë¥¼ ë•Œê°€ ìžˆë‹¤. ì´ë•Œ k6 ì˜ Load Test ë¥¼ ì§„í–‰í•˜ë©´ ë³´ë‹¤ ìˆ˜ì›”í•˜ê²Œ ê°’ì„ ì§€ì •í•  ìˆ˜ ìžˆë‹¤.

> [Test Type](https://grafana.com/docs/k6/latest/testing-guides/test-types/)
{: .prompt-info }

# ì£¼ìš” ì„±ëŠ¥ ì§€í‘œ
- í¼í¬ë¨¼ìŠ¤ í…ŒìŠ¤íŠ¸ì˜ ê²°ê³¼ë¥¼ ë¶„ì„ í• ë•Œ, ë°˜ë“œì‹œ ì•Œì•„ì•¼ í•  ì£¼ìš” ì„±ëŠ¥ ì§€í‘œê°€ ìžˆë‹¤.
	- Latency(ì§€ì—°ì‹œê°„)
	- Throughput(ì²˜ë¦¬ëŸ‰)
	- Iterations(ë°˜ë³µ)

## Latency(ì§€ì—°ì‹œê°„)
- ê³ ê°ì´ ë°°ë‹¬ ì•±ì„ í†µí•´ ì‹ë‹¹ì— ìŒì‹ì„ ì£¼ë¬¸í•˜ê³  ë¬¸ ì•žê¹Œì§€ ë„ì°©í•˜ëŠ” ì‹œê°„ì— ë¹„ìœ í•  ìˆ˜ ìžˆë‹¤.
- ì£¼ë¬¸í•˜ëŠ”ë° 1ë¶„ì´ ê±¸ë ¸ê³ , ìš”ë¦¬í•˜ëŠ”ë° 10ë¶„, ë°°ë‹¬ ì˜¤ëŠ”ë° 10ë¶„ ì´ 21 ë¶„ì´ ì†Œìš”ë˜ì—ˆë‹¤. ì´ë•ŒëŠ” 21 ë¶„ì˜ ì§€ì—°ì‹œê°„ì´ ê±¸ë ¸ë‹¤ê³  í•  ìˆ˜ ìžˆë‹¤.
- ì¸í„°ë„·ì—ì„œ ìš”ì²­ì„ ë³´ë‚´ê³  ì‘ë‹µì„ ë°›ê¸° ì „ê¹Œì§€ë¥¼ ì¸¡ì •í•œ ì§€í‘œ

## Throuput(ì²˜ë¦¬ëŸ‰)
- ì´ë²ˆì—” í•œ ì‹ë‹¹ì— 100 ëª…ì˜ ê³ ê°ì´ ì›¨ì´íŒ…í•˜ê³  ìžˆë‹¤ê³  ê°€ì •
- Throuputì€ ì‹ë‹¹ì´ 1ì‹œê°„ ë™ì•ˆ 100 ëª…ì˜ ê³ ê°ì—ê²Œ ìŒì‹ì„ ëŒ€ì ‘í•  ìˆ˜ ìžˆëŠ”ì§€ì— ë¹„ìœ í•  ìˆ˜ ìžˆë‹¤.
- ì‹ë‹¹ì´ ë†’ì€ Throuputì„ ê°€ì¡Œë‹¤ë©´, 1ì‹œê°„ ë™ì•ˆ 100 ëª…ì˜ ê³ ê°ì—ê²Œ ëª¨ë‘ ìŒì‹ì„ ëŒ€ì ‘í•  ìˆ˜ ìžˆì„ ê²ƒì´ê³ , ë‚®ì€ Throuputì„ ê°€ì¡Œë‹¤ë©´ ê³ ê°ë“¤ì€ ë” ë§Žì€ ì‹œê°„ì„ ê¸°ë‹¤ë ¤ì•¼ í•  ê²ƒì´ë‹¤.

## Iterations(ë°˜ë³µ)
- "A ê³ ê°ì´ ìŒì‹ì„ ì£¼ë¬¸í•˜ê³ , ì‹ë‹¹ì€ ìŒì‹ì„ ì¡°ë¦¬í•˜ê³ , ê³ ê°ì—ê²Œ ìŒì‹ì„ ì œê³µí•©ë‹ˆë‹¤."
- "B ê³ ê°ì´ ìŒì‹ì„ ì£¼ë¬¸í•˜ê³ , ì‹ë‹¹ì€ ìŒì‹ì„ ì¡°ë¦¬í•˜ê³ , ê³ ê°ì—ê²Œ ìŒì‹ì„ ì œê³µí•©ë‹ˆë‹¤."
- "C ê³ ê°ì´ ìŒì‹ì„ ì£¼ë¬¸í•˜ê³ , ì‹ë‹¹ì€ ìŒì‹ì„ ì¡°ë¦¬í•˜ê³ , ê³ ê°ì—ê²Œ ìŒì‹ì„ ì œê³µí•©ë‹ˆë‹¤."
- ì´ë ‡ë“¯ ê°™ì€ í–‰ìœ„ë¥¼ ì–¼ë§ˆë§Œí¼ ì•ˆì •ì ìœ¼ë¡œ ë°˜ë³µí•  ìˆ˜ ìžˆëŠ”ì§€ë¥¼ í…ŒìŠ¤íŠ¸í•˜ëŠ” ì§€í‘œ

# k6ì˜ Lifecycleì€ í¬ê²Œ ë„¤ê°€ì§€

```
# 1. ì´ˆê¸°í™” - init code

# 2. ì „ì²˜ë¦¬ - setup code
export function setup() {
	#ã€€ë¡œê·¸ì¸ í† í°ì·¨ë“ ë“± APIì‹¤í–‰ì „ì— í•„ìš”í•œ ì²˜ë¦¬ êµ¬í˜„
}

# 3. APIì‹¤í–‰(ì‹œë‚˜ë¦¬ì˜¤ ì‹¤í–‰) - VU code
export default function (data) {
	# APIë¥¼ ì‹¤í–‰í•  ì‹œë‚˜ë¦¬ì˜¤ë¥¼ êµ¬í˜„
}

# 4. API ì‹¤í–‰í›„ ì²˜ë¦¬ - teardown code
export function teardown(data) {
	# API ì‹¤í–‰í›„ì— í•„ìš”í•œ ì²˜ë¦¬ê°€ ìžˆë‹¤ë©´ êµ¬í˜„
}
```

1. initì€ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì´ˆê¸°í™”
	- ëª¨ë“ˆ ìž„í¬íŠ¸
	- ë¡œì»¬ íŒŒì¼ ì‹œìŠ¤í…œì—ì„œ íŒŒì¼ ë¡œë“œ
	- ëª¨ë“  ì˜µì…˜ì— ëŒ€í•œ ì„¤ì • í…ŒìŠ¤íŠ¸
	- í•¨ìˆ˜ ì •ì˜ (defaultì—ì„œ ìˆ˜í–‰ í˜¹ì€ setup, teardownì—ì„œ ìˆ˜í–‰)
2. `(ì„ íƒì‚¬í•­)` setupì½”ë“œëŠ” í™˜ê²½ì„ ì¤€ë¹„í•˜ê³ , ë°ì´í„°ë¥¼ ìƒì„±
	- setupì€ init ë‹¤ìŒì— ìˆ˜í–‰ë˜ë©° ì˜¤ì§ í•œë²ˆë§Œ ìˆ˜í–‰
3. VUì½”ë“œëŠ” default í•¨ìˆ˜ì—ì„œ ìˆ˜í–‰. ì‹¤ì œë¡œ í…ŒìŠ¤íŠ¸ ìš”ì²­ì„ ë³´ë‚´ëŠ” ì½”ë“œê°€ ìž‘ì„±ëœë‹¤. ì˜µì…˜ì— ì •ì˜í•œ ë§Œí¼ ë°˜ë³µ ë™ìž‘í•œë‹¤.
	- default í•¨ìˆ˜ì—ì„œ ì‹¤ì œ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰
	- í˜¹ì€ ì˜µì…˜ì—ì„œ íŠ¹ì • ì‹œë‚˜ë¦¬ì˜¤ê°€ ì •ì˜í•œ í•¨ìˆ˜ë¥¼ ìˆ˜í–‰
	- VUì½”ë“œëŠ” í…ŒìŠ¤íŠ¸ê°€ ìˆ˜í–‰ë˜ëŠ” ê¸°ê°„ë™ì•ˆ ì§€ì†ì ìœ¼ë¡œ ë°˜ë³µ ìˆ˜í–‰
	- VUì½”ë“œëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ httpì½”ë“œë¥¼ ìƒì„±í•˜ê³ , ë©”íŠ¸ë¦­ì˜ ìƒì„±, í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ëª¨ë“  ìž‘ì—…ì„ ìˆ˜í–‰
	- job í•¨ìˆ˜ë¥¼ ì œì™¸í•˜ê³  ëª¨ë“  ìž‘ì—…ì´ ìˆ˜í–‰ë˜ë©°, jobì€ inití•¨ìˆ˜ì—ì„œ ìˆ˜í–‰
		- VUì½”ë“œëŠ” ë¡œì»¬ íŒŒì¼ì„ ì½ì„ ìˆ˜ ì—†ë‹¤.
		- VUì½”ë“œëŠ” ì–´ë– í•œ ëª¨ë“ˆë„ ë¡œë“œí•  ìˆ˜ ì—†ë‹¤.
4. `(ì„ íƒì‚¬í•­)` teardown í•¨ìˆ˜ëŠ” í…ŒìŠ¤íŠ¸ì˜ í™˜ê²½ì„ ì •ë¦¬í•˜ê³ , ìžì›ì„ ë¦´ë¦¬ì¦ˆí•œë‹¤.
	- teardownì€ í…ŒìŠ¤íŠ¸ ëë‚ ë•Œ í•œë²ˆë§Œ ìˆ˜í–‰ë˜ë©° VU ì½”ë“œê°€ ì¢…ë£Œë˜ê³  ë‚œë’¤ ë°”ë¡œ ìˆ˜í–‰

## setup, teardown ìŠ¤í‚µ

- `--no-setup` ì˜µì…˜ì„ ì´ìš©í•˜ì—¬ ì…‹ì—…ì„ ìŠ¤í‚µí•œë‹¤.
- `--no-teardown` ì˜µì…˜ì„ ì´ìš©í•˜ì—¬ teardown ì„ ìŠ¤í‚µí•œë‹¤.

```
k6 run --no-setup --no-teardown ...
```

## setupì—ì„œ ì •ì˜í•œ ë°ì´í„°ë¥¼ ì „ë‹¬

- setupì—ì„œ ì •ì˜í•œ ë°ì´í„°ë¥¼ default functionê³¼ teardown ìœ¼ë¡œ ì „ë‹¬

```
export function setup() {
  return { v: 1 };
}

export default function (data) {
  console.log(JSON.stringify(data));
}

export function teardown(data) {
  if (data.v != 1) {
    throw new Error('incorrect data: ' + JSON.stringify(data));
  }
}
```

- setupì—ì„œ ë°ì´í„°ë¥¼ returnì„ í•˜ê²Œ ë˜ë©´ ì´ return ëœ ê°ì²´ê°€ ì „ë‹¬ì´ ë˜ëŠ” ë°©ì‹ì´ë‹¤.
- ì´í›„ defult, teardownì—ì„œ dataë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ ë°›ì„ ìˆ˜ ìžˆë‹¤.
	- ë°ì´í„°ëŠ” ì˜¤ì§ json ë°ì´í„°ë§Œ ì „ë‹¬ê°€ëŠ¥í•˜ë©°, í•¨ìˆ˜ëŠ” ì „ë‹¬ë¶ˆê°€ì´ë‹¤.
	- ë°ì´í„°ê°€ ë„ˆë¬´ í¬ë©´ ë” ë§Žì€ ë©”ëª¨ë¦¬ê°€ ì‚¬ìš©ëœë‹¤.
	- default() ì—ì„œ ë°ì´í„°ë¥¼ ë³€ê²½í•  ìˆ˜ ì—†ë‹¤.

> [Test Life Cycle](https://grafana.com/docs/k6/latest/using-k6/test-lifecycle/)
{: .prompt-info }

# Test Code ìž‘ì„± ë°©ë²•

- k6 ëŠ” ê°€ìƒ ìœ ì €ë¥¼ ë§Œë“¤ì–´ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì›í•˜ëŠ” ìš”ì²­ì„ ë°˜ë³µì ìœ¼ë¡œ ë³´ë‚´ê²Œ ëœë‹¤.

```
import http from "k6/http"		# http test
import { sleep } from "k6"		# sleep ê¸°ëŠ¥ ì‚¬ìš© ì‹œ ì¶”ê°€ (sleep(n) â†’ ì§€ì •í•œ n ê¸°ê°„ ë™í•œ VU ì‹¤í–‰ì„ ì¼ì‹œ ì¤‘ì§€)

export let options = {
	vus: 10,          # ê°€ìƒì˜ ìœ ì € ìˆ˜
	duration: '1m'    # í…ŒìŠ¤íŠ¸ ì§„í–‰ ì‹œê°„
};

const BASE_URL = 'http://test.k6.io';		# í…ŒìŠ¤íŠ¸ URL

export default function () {
	let getUrl = BASE_URL
	http.get(getUrl);
	sleep(1);
}
```

- 10ëª…ì˜ ê°€ìƒ ìœ ì €ê°€ 10s ë™ì•ˆ http://test.k6.io ì„ í˜¸ì¶œ

> 1ëª…ì˜ ê°€ìƒ ìœ ì €ê°€ í•œë²ˆë§Œ default functionì„ í˜¸ì¶œí•˜ëŠ” ê²ƒì´ ì•„ë‹Œ, 60ì´ˆ ë™ì•ˆ í•´ë‹¹ í•¨ìˆ˜ë¥¼ ê³„ì† í˜¸ì¶œí•œë‹¤.\\
ì¦‰, default functionì„ 1ëª…ì”© 1ë²ˆ í˜¸ì¶œí•´ì„œ ì´ 10ë²ˆ í˜¸ì¶œí•˜ëŠ” ê²ƒì´ ì•„ë‹Œ, 1ëª…ì˜ ê°€ìƒìœ ì €ê°€ 5~10ë²ˆ ì •ë„ í˜¸ì¶œí•œë‹¤.
{: .prompt-info }

> Production í™˜ê²½ì´ ì•„ë‹Œ Dev ë˜ëŠ” Staging í™˜ê²½ì—ì„œ ì§„í–‰\\
ì„±ëŠ¥ì„ ë¶„ì„í•  ë•Œ, ì ˆëŒ€ í‰ê· ê°’ìœ¼ë¡œ íŒë‹¨í•˜ì§€ ì•Šê¸°\\
í´ë¼ìš°ë“œ í™˜ê²½ì„ ì´ìš©í•œë‹¤ë©´, k6ë¥¼ í…ŒìŠ¤íŠ¸í•  ë•Œ Scale Up, Outì— ì£¼ì˜
{: .prompt-warning }

## Test Code ìž‘ì„± ì˜ˆì‹œ

```
import http from "k6/http";
import { sleep, check } from "k6";
import { Trend } from "k6/metrics";

const trends = {
  scenario1: new Trend("scenario1) Response time", true),
  scenario2: new Trend("scenario2) Response time", true),
};

const VUS = 1;
const DURATION = "10s";

export const options = {
  scenarios: {
    scenario1: {
      executor: "constant-vus",
      exec: "scenarioFunc",
      vus: VUS,
      duration: DURATION,
      env: {
        SCENARIO_ID: "1",
      },
    },
    scenario2: {
      executor: "constant-vus",
      exec: "scenarioFunc",
      vus: VUS,
      duration: DURATION,
      env: {
        SCENARIO_ID: "2",
      },
    },
  },
};

export function setup() {
  const url = ""; // tokenì·¨ë“
  const params = {
    headers: {
      Authorization: "Bearer XXX",
    },
  };
  const res = http.get(url, params);
  const token = JSON.parse(res.body).account.token;

  return token;
}

export function scenarioFunc(token) {
  const scenarioUrl = ""; // ì‹¤í–‰í•  API
  const scenario = http.get(scenarioUrl, {
    headers: {
      Authorization: `Bearer ${token}`,
    },
  });
  __ENV.SCENARIO_ID === "1"
    ? trends.scenario1.add(scenario.timings.duration)
    : trends.scenario2.add(scenario.timings.duration);

  check(scenario, {
    "scenario status is 200": (res) => res.status === 200,
  });

  sleep(1);
}
```

### Option ê´€ë ¨

```
export const options = {
  scenarios: {
    scenario1: {
      executor: "constant-vus",
      exec: "scenarioFunc",
      vus: VUS,
      duration: DURATION,
      env: {
        SCENARIO_ID: "1",
      },
    },
  },
};
```

- executor: k6ì˜ ì‹¤í–‰ ì—”ì§„ì„ ë‚˜íƒ€ë‚¸ë‹¤.
	- ì—¬ê¸°ì—ì„œ VU(Virtual user)ë‚˜ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ íŒ¨í„´ì„ ì§€ì •í•  ìˆ˜ ìžˆë‹¤.
	- ìžì„¸í•œ ë‚´ìš©ì€ k6ì˜ [executors](https://grafana.com/docs/k6/latest/using-k6/scenarios/executors/)ë¥¼ ì°¸ì¡°
- exec: ì‹¤í–‰í•˜ê³ ìž í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì§€ì •
- vus: Virtual Users APIë¥¼ ì‹¤í–‰í•  ê°€ìƒ ìœ ì €. í•„ìš”í•œ ë§Œí¼ì˜ ë³‘ë ¬ ì‹¤í–‰ ìˆ˜ë¥¼ ì—¬ê¸°ì— ì„¤ì •
- duration: VUSê°€ ë°˜ë³µ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹¤í–‰í•˜ëŠ” ì‹œê°„ì„ ì„¤ì •
- env: ê³µí†µìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ë³€ìˆ˜ë¥¼ ì„¤ì •

### Trend ê´€ë ¨

```
const trends = {
  scenario1: new Trend("scenario1) Response time", true),
  scenario2: new Trend("scenario2) Response time", true),
};
```

- TrendëŠ” ì‹¤í–‰ ê²°ê³¼ì— í¬í•¨í•  User ì§€ì • Metric
- ì‹œë‚˜ë¦¬ì˜¤ë³„ ì‘ë‹µ ì‹œê°„ì„ í†µí•´ ì‹¤í–‰ ê²°ê³¼ì— í¬í•¨ì‹œí‚¤ê¸° ìœ„í•´ ì¶”ê°€
- Trendë¥¼ ì¶”ê°€í•˜ë©´ ì•„ëž˜ì™€ ê°™ì´ ì‹¤í–‰ ê²°ê³¼ì—ì„œ ë³¼ ìˆ˜ ìžˆë‹¤.

```
scenario1) Response time.......: avg=1.29s    min=1.26s    med=1.29s max=1.35s    p(90)=1.34s    p(95)=1.34s
scenario2) Response time.......: avg=1.29s    min=1.25s    med=1.29s max=1.36s    p(90)=1.32s    p(95)=1.34s
```

### Setup ê´€ë ¨

```
export function setup() {
  const url = "";
  const params = {
    headers: {
      Authorization: "Bearer XXX",
    },
  };
  const res = http.get(url, params);
  const token = JSON.parse(res.body).account.token;

  return token;
}
```

- ì—¬ê¸°ì—ì„œ í† í° ì·¨ë“ ë“± ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹¤í–‰í•˜ê¸° ì „ì— ì‹¤í–‰ë˜ì–´ì•¼í•  ì²˜ë¦¬ë¥¼ ì„¤ì •í•˜ëŠ” ê³³
- ë¡œê·¸ì¸ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤ë¥¼ ê°€ì •í•˜ì—¬ í† í°ì„ ì·¨ë“

### scenario ê´€ë ¨

```
export function scenarioFunc(token) {
  const scenarioUrl = "";
  const scenario = http.get(scenarioUrl, {
    headers: {
      Authorization: `Bearer ${token}`,
    },
  });
  __ENV.SCENARIO_ID === "1"
    ? trends.scenario1.add(scenario.timings.duration)
    : trends.scenario2.add(scenario.timings.duration);

  check(scenario, {
    "scenario status is 200": (res) => res.status === 200,
  });

  sleep(1);
}
```

- ì—¬ê¸°ì„œ ì‹¤í–‰í•˜ê³  ì‹¶ì€ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ìž‘ì„±
- ê°™ì€ APIë¥¼ ì‹¤í–‰í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ê°€ 2ê°œì´ê¸° ë•Œë¬¸ì— ê·¸ì— ë”°ë¼ Trendë¥¼ ì‹¤í–‰ ì‹œë‚˜ë¦¬ì˜¤ ì•„ì´ë””ë¡œ ë¶„ë¦¬

- checkë©”ì„œë“œëŠ” ê°’ì— ëŒ€í•´ true/falseë¥¼ ë°˜í™˜
- ì—¬ê¸°ì—ì„œ APIì‹¤í–‰ì´ ì„±ê³µí–ˆëŠ”ì§€ ì‹¤íŒ¨í–ˆëŠ”ì§€ í™•ì¸í•˜ê³  ê²°ê³¼ì— ê¸°ë¡
- ì‹¤íŒ¨í•´ë„ ì¤‘ê°„ì— ë©ˆì¶”ì§€ ì•Šê³  ì‹¤í–‰í•˜ê¸° ë•Œë¬¸ì— ìœ ì—°í•˜ê²Œ ëŒ€ì‘í•  ìˆ˜ ìžˆë‹¤.


> [k6 http module](https://grafana.com/docs/k6/latest/javascript-api/k6-http/)
{: .prompt-info }

> [k6 javascript-api](https://grafana.com/docs/k6/latest/javascript-api/)
{: .prompt-info }

## Result

```
          /\      |â€¾â€¾| /â€¾â€¾/   /â€¾â€¾/
     /\  /  \     |  |/  /   /  /
    /  \/    \    |     (   /   â€¾â€¾\
   /          \   |  |\  \ |  (â€¾)  |
  / __________ \  |__| \__\ \_____/ .io

  execution: local
     script: scripts.js
     output: -

  scenarios: (100.00%) 2 scenario, 200 max VUs, 40s max duration (incl. graceful stop):
           * scenario1: 1 looping VUS for 10s (exec: scenarioFunc, gracefulStop: 30s)
           * scenario2: 1 looping VUS for 10s (exec: scenarioFunc, gracefulStop: 30s)


running (11.9s), 0/2 VUS, 16 complete and interrupted iterations
scenario1 âœ“ [======================================] 1 VUS 10s
scenario2 âœ“ [======================================] 1 VUS 10s

     âœ“ scenario status is 200
	 
     ðŸ¢ setup

     checks.........................: 100.00% âœ“ 2893      âœ— 0
     data_received..................: 3.5 MB  58 kB/s
     data_sent......................: 416 kB  6.9 kB/s
     http_req_blocked...............: avg=49.33ms min=1Âµs      med=3Âµs   max=3.45s    p(90)=16Âµs    p(95)=377.18ms
     http_req_connecting............: avg=13.09ms min=0s       med=0s    max=199.77ms p(90)=0s      p(95)=186.36ms
     http_req_duration..............: avg=2.14s   min=190.5ms  med=1.32s max=5.79s    p(90)=5.39s   p(95)=5.57s
       { expected_response:true }...: avg=2.14s   min=190.5ms  med=1.32s max=5.79s    p(90)=5.39s   p(95)=5.57s
     http_req_failed................: 0.00%   âœ“ 0         âœ— 2893
     http_req_receiving.............: avg=81.97Âµs min=19Âµs     med=61Âµs  max=2.43ms   p(90)=141.8Âµs p(95)=205.4Âµs
     http_req_sending...............: avg=22.37Âµs min=5Âµs      med=16Âµs  max=687Âµs    p(90)=38Âµs    p(95)=57Âµs
     http_req_tls_handshaking.......: avg=36.2ms  min=0s       med=0s    max=3.2s     p(90)=0s      p(95)=190.18ms
     http_req_waiting...............: avg=2.14s   min=190.38ms med=1.32s max=5.79s    p(90)=5.39s   p(95)=5.57s
     http_reqs......................: 2893    48.176768/s
     iteration_duration.............: avg=2.19s   min=190.7ms  med=1.39s max=6.05s    p(90)=5.4s    p(95)=5.58s
     iterations.....................: 2893    48.176768/s
     scenario1) Response time.......: avg=1.29s   min=1.26s    med=1.29s max=1.36s    p(90)=1.32s   p(95)=1.34s
     scenario2) Response time.......: avg=1.29s   min=1.25s    med=1.29s max=1.36s    p(90)=1.32s   p(95)=1.34s
     vus............................: 2       min=0       max=2
     vus_max........................: 2       min=2       max=2
```

- checks
	- ê²°ê³¼ : 100.00% âœ“ 2893 âœ— 0
	- ì˜ë¯¸ : ìš”ì²­ì´ ì„±ê³µí•œ ë¹„ìœ¨(%)

- data_received
	- ê²°ê³¼ : 3.5 MB  58 kB/s
	- ì˜ë¯¸ : ì‘ë‹µí•œ ë°ì´í„° ì–‘ (Total, /s)

- data_sent
	- ê²°ê³¼ : 416 kB  6.9 kB/s
	- ì˜ë¯¸ : ìš”ì²­í•œ ë°ì´í„° ì–‘ (Total, /s)

- http_req_blocked
	- ê²°ê³¼ : avg=49.33ms min=1Âµs      med=3Âµs   max=3.45s    p(90)=16Âµs    p(95)=377.18ms
	- ì˜ë¯¸ : TCP ì ‘ì† ëŒ€ê¸°ì‹œê°„(avg, min, med, max, p(90), p(95)

- http_req_connecting
	- ê²°ê³¼ : avg=13.09ms min=0s       med=0s    max=199.77ms p(90)=0s      p(95)=186.36ms
	- ì˜ë¯¸ : TCP ì ‘ì†ì— ê±¸ë¦°ì‹œê°„(avg, min, med, max, p(90), p(95)

- http_req_duration
	- ê²°ê³¼ : avg=2.14s   min=190.5ms  med=1.32s max=5.79s    p(90)=5.39s   p(95)=5.57s
	- ì˜ë¯¸ : ìš”ì²­ â†’ ì‘ë‹µ ê¹Œì§€ ì–¼ë§ˆë‚˜ ê±¸ë ¸ëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì§€í‘œ. http_req_sending + http_req_waiting + http_req_receiveing(avg, min, med, max, p(90), p(95)

- { expected_response:true }
	- ê²°ê³¼ : avg=2.14s   min=190.5ms  med=1.32s max=5.79s    p(90)=5.39s   p(95)=5.57s
	- ì˜ë¯¸ : ì •ìƒì‘ë‹µë§Œ http_req_duration(avg, min, med, max, p(90), p(95) ì •ìƒì‘ë‹µì´ ì—†ì„ ê²½ìš° ì´ í•­ëª©ì€ í‘œì‹œë˜ì§€ ì•ŠìŒ

- http_req_failed
	- ê²°ê³¼ : 0.00%   âœ“ 0   âœ— 2893
	- ì˜ë¯¸ : ìš”ì²­ì´ ì‹¤íŒ¨í•œ ë¹„ìœ¨(%)

- http_req_receiving
	- ê²°ê³¼ : avg=81.97Âµs min=19Âµs     med=61Âµs  max=2.43ms   p(90)=141.8Âµs p(95)=205.4Âµs
	- ì˜ë¯¸ : ì‘ë‹µì˜ 1ë°”ì´íŠ¸ê°€ ë„ë‹¬í•˜ê³  ë‚˜ì„œ ë§ˆì§€ë§‰ ë°”ì´íŠ¸ë¥¼ ìˆ˜ì‹ í•  ë•Œê¹Œì§€ì˜ ì‹œê°„(avg, min, med, max, p(90), p(95)

- http_req_sending
	- ê²°ê³¼ : avg=22.37Âµs min=5Âµs      med=16Âµs  max=687Âµs    p(90)=38Âµs    p(95)=57Âµs
	- ì˜ë¯¸ : ìš”ì²­ì„ ì „ì†¡í•˜ëŠ”ë° ê±¸ë¦°ì‹œê°„(avg, min, med, max, p(90), p(95)

- http_req_tls_handshaking
	- ê²°ê³¼ : avg=36.2ms  min=0s       med=0s    max=3.2s     p(90)=0s      p(95)=190.18ms
	- ì˜ë¯¸ : TLS ì„¸ì…˜ì˜ í•¸ë“œì‰ì´í¬ì— ê±¸ë¦° ì‹œê°„(avg, min, med, max, p(90), p(95) httpì—ì„œëŠ” 0

- http_req_waiting
	- ê²°ê³¼ : avg=2.14s   min=190.38ms med=1.32s max=5.79s    p(90)=5.39s   p(95)=5.57s
	- ì˜ë¯¸ : ìš”ì²­ì´ ì „ì†¡ ì™„ë£Œëœ í›„ ì‘ë‹µì´ ì‹œìž‘ë  ë•Œê¹Œì§€ì˜ ì‹œê°„(avg, min, med, max, p(90), p(95) TTFB(Time To First Byte)

- http_reqs
	- ê²°ê³¼ : 2893    48.176768/s
	- ì˜ë¯¸ : ì´ ë¦¬í€˜ìŠ¤íŠ¸ìˆ˜ (Total, /s)

- iteration_duration
	- ê²°ê³¼ : avg=2.19s   min=190.7ms  med=1.39s max=6.05s    p(90)=5.4s    p(95)=5.58s
	- ì˜ë¯¸ : ì‹œë‚˜ë¦¬ì˜¤ 1íšŒ ë°˜ë³µì— ê±¸ë¦° ì‹œê°„(avg, min, med, max, p(90), p(95)

- iterations
	- ê²°ê³¼ : 2893    48.176768/s
	- ì˜ë¯¸ : ì‹œë‚˜ë¦¬ì˜¤ ë°˜ë³µ íšŸìˆ˜(Total, /s)

- vus
	- ê²°ê³¼ : 2 min=0 max=2
	- ì˜ë¯¸ : Virtual Users, ì‹œë‚˜ë¦¬ì˜¤ ì‹¤í–‰ì‹œ ìœ ì €ìˆ˜(ë³‘ë ¬)

- vus_max
	- ê²°ê³¼ : 2 min=0 max=2
	- ì˜ë¯¸ : ìµœëŒ€ Virtual Users, ì‹œë‚˜ë¦¬ì˜¤ì˜ ìµœëŒ€ ì‹¤í–‰ìœ ì €ìˆ˜(ë³‘ë ¬)

### p(90)ê³¼ p(95)ì˜ ì˜ë¯¸
- p ëŠ” percentile ì„ ì˜ë¯¸í•˜ê³  ë’¤ì— 90, 95 ëŠ” ê°ê° 90%, 95% ë¥¼ ì˜ë¯¸
	- p(90)ì€ "90%ì˜ ìš”ì²­ì´ ì£¼ì–´ì§„ ì§€ì—°ë³´ë‹¤ ë¹ ë¥´ê±°ë‚˜ ë™ì¼í•œ ì‹œê°„ ì•ˆì— ì™„ë£Œëœë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸"
	- p(95)ëŠ” "95%ì˜ ìš”ì²­ì´ ì£¼ì–´ì§„ ì§€ì—°ë³´ë‹¤ ë¹ ë¥´ê±°ë‚˜ ë™ì¼í•œ ì‹œê°„ ì•ˆì— ì™„ë£Œëœë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸"

#### 500ëª…ì˜ ê³ ê°ë“¤ì´ í–„ë²„ê±°ë¥¼ ì£¼ë¬¸í–ˆë‹¤ê³  ê°€ì •
1. 80%ì¸ 400 ëª…ì€ 20ì´ˆ ì•ˆì— í–„ë²„ê±°ë¥¼ ë°›ì•˜ê³ , 20%ì¸ 100 ëª…ì€ í–„ë²„ê±°ë¥¼ ë°›ê¸°ê¹Œì§€ 10ë¶„ ì´ìƒì´ ê±¸ë ¸ë‹¤.
2. ì´ë•Œ í‰ê· ì ìœ¼ë¡œ í•œ ê³ ê°ì´ í–„ë²„ê±°ë¥¼ ë°›ê¸°ê¹Œì§€ ì•½ 4ë¶„ì´ ì†Œìš”
3. ëŒ€ë¶€ë¶„ì˜ ì‚¬ëžŒë“¤ì´ 20ì´ˆ ë‚´ì— í–„ë²„ê±°ë¥¼ ë°›ì•˜ìŒì—ë„ ë¶ˆêµ¬í•˜ê³  í‰ê·  ì‹œê°„ì€ 4ë¶„ìœ¼ë¡œ ì¸¡ì •ë˜ê¸° ë•Œë¬¸ì— í–„ë²„ê±°ë¥¼ ë°›ê¸°ê¹Œì§€ì˜ ì‹œê°„ì´ ì˜¤ëž˜ ê±¸ë¦°ë‹¤ê³  ìƒê°í•  ìˆ˜ ìžˆë‹¤. 

- ì´ë ‡ë“¯ í‰ê· ì€ ì‹¤ì œë¡œ ì „ì²´ ì„±ëŠ¥ì„ ë§í•´ì£¼ê¸°ì—” í•¨ì •ì´ ìžˆë‹¤.
- ë”°ë¼ì„œ í¼í¬ë¨¼ìŠ¤ ì¸¡ì •ì„ ì§„í–‰ í•  ë•ŒëŠ” í‰ê· ì„ ë³´ëŠ” ê²ƒì— ì£¼ì˜ë¥¼ ì£¼ì–´ì•¼ í•˜ë©°, í‰ê· ë³´ë‹¤ëŠ” p(90)ê³¼ p(95)ê°€ ë” ì¤‘ìš”í•˜ë‹¤.

#### 100ë§Œ ê±´ì˜ ìš”ì²­ì„ ë³´ëƒˆì„ ë•Œ, ëª¨ë“  ìš”ì²­ì€ 1ì´ˆ ë‚´ì— ì´ë£¨ì–´ì ¸ì•¼ í•˜ëŠ”ë°, ë”± í•˜ë‚˜ì˜ ìš”ì²­ë§Œì´ 1ë¶„ì´ ê±¸ë ¸ë‹¤ê³  ê°€ì •
- ì¼ë°˜ì ì¸ ê´€ì ì—ì„œëŠ” ì‹¤íŒ¨ë¡œ ë³¼ ìˆ˜ ìžˆì§€ë§Œ, Service Level Objective(SLO) ê´€ì ì—ì„œ ë°”ë¼ë³´ë©´ ì„±ê³µ. ì™œëƒí•˜ë©´ SLOì—ì„œ 100%ëŠ” ìžˆì„ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì´ë‹¤.
- AWS S3 ì„œë¹„ìŠ¤ë§Œ ë´ë„ [99.999999999%ì˜ ë‚´êµ¬ì„±ê³¼ 99.99%ì˜ ê°€ìš©ì„±ì„ ì œê³µ](https://docs.aws.amazon.com/ko_kr/AmazonS3/latest/userguide/DataDurability.html)í•œë‹¤ê³  í•©ë‹ˆë‹¤.

## [Test í‘œì¤€ ì¸¡ì • í•­ëª©](https://grafana.com/docs/k6/latest/using-k6/metrics/reference/#standard-built-in-metrics)

| Metric Name | Type | Description |
|:-|:-|:-|
| vus | Gauge | í˜„ìž¬ í™œì„±í™” ëœ ì‚¬ìš©ìž ìœ ì € |
| vus_max | Gauge | ê°€ëŠ¥í•œ ìµœëŒ€ ê°€ìƒ ì‚¬ìš©ìž ìˆ˜(ë¡œë“œ ë ˆë²¨ì„ í™•ìž¥í•  ë•Œ ì„±ëŠ¥ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šë„ë¡ VU ë¦¬ì†ŒìŠ¤ê°€ ë¯¸ë¦¬ í• ë‹¹ë¨) |
| iterations | Counter | í…ŒìŠ¤íŠ¸ì—ì„œ Vu ê°€ JS ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•œ ì´ íšŸìˆ˜ |
| iteration_duration | Trend | default/main function ì˜ ì „ì²´ ë°˜ë³µì„ í•œ ë²ˆ ì™„ë£Œí•˜ëŠ”ë° ì†Œìš”ëœ ì‹œê°„ |
| dropped_iterations | Counter | k6 v0.27.0 ì— ë„ìž…ëœ VU lack ë˜ëŠ” lack of time ìœ¼ë¡œ ì¸í•´ ì‹œìž‘í•  ìˆ˜ ì—†ëŠ” ë°˜ë³µ íšŒìˆ˜ |
| data_received | Counter | ë°ì´í„°ë¥¼ ì „ë‹¬ë°›ì€ ì–‘ |
| data_sent | Counter | ë°ì´í„°ë¥¼ ì „ë‹¬í•œ ì–‘ |
| checks | Rate | ì„±ê³µì ìœ¼ë¡œ ì²´í¬ëœ Rate |

## [Http ì¸¡ì • í•­ëª©](https://grafana.com/docs/k6/latest/using-k6/metrics/reference/#http)

| Metric Name | Type | Description |
|:-|:-|:-|
| http_reqs | Counter | ì´ ì–¼ë§ˆë‚˜ ë§Žì€ HTTP requests ë¥¼ k6 ì—ì„œ ìƒì„±í–ˆëŠ”ì§€ íšŸìˆ˜ |
| http_req_blocked | Trend | ìš”ì²­ì„ ì‹œìž‘í•˜ê¸° ì „ì— ì°¨ë‹¨ëœ ì‹œê°„(TCP connection slot ì„ ê¸°ë‹¤ë¦¬ëŠ”) ë‹¨ìœ„: float |
| http_req_connecting | Trend | ì›ê²© í˜¸ìŠ¤íŠ¸ì— ëŒ€í•œ TCP ì—°ê²°ì„ ì„¤ì •í•˜ëŠ”ë° ì†Œìš”ëœ ì‹œê°„. ë‹¨ìœ„: float |
| http_req_tls_handshaking | Trend | ì›ê²© í˜¸ìŠ¤íŠ¸ì™€ì˜ í•¸ë“œì…°ì´í‚¹ TLS ì„¸ì…˜ì— ì†Œìš”ëœ ì‹œê°„ |
| http_req_sending | Trend | ì›ê²© í˜¸ìŠ¤íŠ¸ì— ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ”ë° ì†Œìš”ëœ ì‹œê°„. ë‹¨ìœ„: float |
| http_req_waiting | Trend | ì›ê²© í˜¸ìŠ¤íŠ¸ë¡œë¶€í„°ì˜ ì‘ë‹µì„ ëŒ€ê¸°í•˜ëŠ” ë° ì†Œìš”ëœ ì‹œê°„ (a.k.a. â€œtime to first byteâ€, or â€œTTFBâ€). ë‹¨ìœ„: float |
| http_req_receiving | Trend | ì›ê²© í˜¸ìŠ¤íŠ¸ë¡œë¶€í„° ì‘ë‹µ ë°ì´í„°ë¥¼ ìˆ˜ì‹ í•˜ëŠ” ë° ì†Œìš”ëœ ì‹œê°„. ë‹¨ìœ„: float |
| http_req_duration | Trend | ìš”ì²­ì˜ ì´ ì‹œê°„. It's equal to http_req_sending + http_req_waiting + http_req_receiving (ì¦‰, ì´ˆê¸° DNS ì¡°íšŒ/ì—°ê²° ì‹œê°„ ì—†ì´ ì›ê²© ì„œë²„ê°€ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê³  ì‘ë‹µí•˜ëŠ” ë° ì†Œìš”ëœ ì‹œê°„s). ë‹¨ìœ„: float |
| http_req_failed | Rate | [setResponseCallback](https://k6.io/docs/javascript-api/k6-http/setresponsecallback/) ì— ë”°ë¥¸ ìš”ì¹­ ì‹¤íŒ¨ ë¹„ìœ¨. |

> [ì¶œë ¥ ê°€ëŠ¥í•œ ì˜µì…˜](https://grafana.com/docs/k6/latest/results-output/real-time/)
{: .prompt-info }

> [Swagger API](https://k6.io/blog/load-testing-your-api-with-swagger-openapi-and-k6/)
{: .prompt-info }

> [Postman](https://grafana.com/blog/2020/04/19/load-testing-your-api-with-postman/)
{: .prompt-info }

> [k6-learn](https://github.com/grafana/k6-learn)
{: .prompt-info }
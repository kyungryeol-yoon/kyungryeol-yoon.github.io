---
title: "About Argo-CD"
date: 2021-10-17
# categories: [Python, FastAPI]
tags: [Argo CD, Kubernetes, GitOps, DevOps]
---

- Argo CD는 GitOps 스타일의 배포를 지원하는 CD 도구
- Git 저장소의 내용과 Kubernetes 클러스터를 동기화해주는 역할을 하는 에이전트

### 작동 원리
- Argo CD는 원하는 애플리케이션 상태를 정의하기위한 소스로 Git repository를 사용하는 GitOps 패턴을 따른다.
- Kubernetes 매니페스트는 여러 방법으로 지정할 수 있다.
- Argo CD는 지정된 대상 환경에서 원하는 애플리케이션 상태의 배포를 자동화한다.

![](/images/kubernetes/argo-cd/argo-cd-architecture.png)

### 설치
```terminal
$ kubectl create namespace argocd
$ kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml
```

### GitOps
- 핵심은 git repository에 저장된 Kubernetes manifests 같은 파일을 이용하여 배포를 선언적으로 하는 것이다.
- git 저장소에 있는 것을 Kubernetes 클러스터에 동기화한다.

#### 기존의 배포 방식
1. 개발자가 소스코드를 작성
2. git 저장소에 push
3. Jenkins, CircleCI, Github Action과 같은 CI를 통해 테스트와 빌드 작업
4. 생성한 Container Image를 저장소(Harbor)에 업로드
5. CI/CD는 업로드 된 Container Image의 정보를 참조해서 서버에 배포

![](/images/kubernetes/argo-cd/argo-cd-001.png)

#### GitOps의 배포방식
1. (기존과 동일) 개발자가 소스코드를 작성한다.
2. (기존과 동일) Git저장소에 올린다.
3. (기존과 동일) Jenkins, CircleCI, Github Action과 같은 CI툴에 의해서 테스트와 빌드 같은 작업이 실행되고 생성한 컨테이너 이미지를 컨테이너 저장소(ECR)에 업로드 한 후
4. 매니페스트가 저장된 Git 저장소를 가져온다.
5. 그리고 매니페스트의 특정 부분(예를 들면 이미지 태그)을 업데이트한 후 Git 저장소에 올리고 작업을 종료한다.

![](/images/kubernetes/argo-cd/argo-cd-002.png)